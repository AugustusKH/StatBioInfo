---
title: "Home Word 5"
author: "Pakorn Sagulkoo 6380064520"
date: "14/10/2563"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exercise
1. There are many ways to test for a normal distribution. Use the golub data and select
the CCND3 Cyclin D3 expression values and the other expression values of two more
genes to perform the following calculations for the normality test, compare and explain
the results.
  1.1 Plot the Histogram and Boxplot for this gene expression.
  
```{r echo = FALSE, message = FALSE, warning = FALSE}
library(multtest); data(golub)
gol.fac <- factor(golub.cl, levels=0:1, labels = c("ALL","AML"))
library(nortest)
```
  
```{r}
hist(golub[1042,], main="Histogram of CCND3 Cyclin D3 expression values", xlab = "CCND3 Cyclin D3 expression values")
```
```{r}
boxplot(golub[1042,], main="CCND3 Cyclin D3 expression values")
```
  1.2 Plot the Q-Q plot to check the normality.
  
```{r}
qqnorm(golub[1042,], main = "CCND3 Cyclin D3")
qqline(golub[1042,])
```
```{r}
qqnorm(golub[1029,], main = "MVK Mevalonate kinase")
qqline(golub[1029,])
```
```{r}
qqnorm(golub[79,], main = "AQP3 Aquaporin 3")
qqline(golub[79,])
```
  1.3 Use the normality tests like Shapiro-Wilk test and Anderson-Darling test.
  
```{r}
shapiro.test(golub[1042,])
```
```{r}
ad.test(golub[1042,])
```
```{r}
shapiro.test(golub[1029,])
```
```{r}
ad.test(golub[1029,])
```
```{r}
shapiro.test(golub[79,])
```
```{r}
ad.test(golub[79,])
```
  1.4 Compare and explain the results.
    From the normality test to three gene expressions (CCND3 Cyclin D3, MVK Mevalonate kinase, and AQP3 Aquaporin 3), The p-values of three genes in both normality test (Shapiro-Wilk and Anderson-Darling) indicate that they are distributed normally although the Q-Q plots have some degree of non-normality.
    
2. A famous athlete has an impressive career, winning 70% of her 500 career matches.
However, this athlete gets criticized because in important events, such as the Olympics,
she has a losing record of 8 wins and 9 losses.
  2.1 Perform a Fisher’s exact test and a Chi-square test to determine if this losing
record can be simply due to chance as opposed to not performing well under pressure.

```{r}
prob = c(0.7,0.3)
olym = c(8,9)
chisq.test(olym, p=prob)
```
```{r}
dat <- matrix(c(8,9,350,150),2,byrow=TRUE)
fisher.test(dat)
```
  
  2.2 Discuss the results of Item 2.1.
    Because p-value from chisquare test is less than 0.05, null hypothesis is rejected. The conclusion is that the losing record in the Olympics can be due to other causes more than the chance. However, Fisher's exact test reveals that there is not statistical significance among 2 situations.
    
3. Use the gene expression data of bacteria in aerobic and anaerobic nutrient conditions
(“mygenes.txt”). We want to find which genes are differentially expressed with using
the t-test.
  3.1 Perform the two-sample t-test to check which genes whose expression values
of the aerobic condition significantly differ from those of the anaerobic condition.

```{r}
file_read <- read.table("C:/Users/hp/Desktop/Bioinfor MSc/Stat for Bioinfo/mygenes.txt", header= TRUE, fileEncoding="UCS-2LE")
gene_value <- file_read[,2:7]
gene_name <- file_read[,1]
gene.fac <- factor(c(0,0,0,1,1,1), 0:1, labels = c("Aerobes","Anaerobes"))
p_value <-apply(gene_value, 1, function(x) t.test(x~gene.fac, var.equal= FALSE)$p.value)
file_read[p_value < 0.05,1]
```
  3.2 After getting the p-value for the test, perform the multiple-test correction and
then report the gene names, the difference of means, original p-values and adjusted pvalues for all genes as a table into a file (namely “my_siggenes_p_adjusted.txt”).
  
```{r}
diff_mean <- apply(gene_value, 1, function(x) t.test(x~gene.fac, var.equal = FALSE )$estimate)
sum_diff <- diff_mean[1,]-diff_mean[2,]
correct_p_value <- p_value * 30
sum_table <- cbind(gene_name,p_value,correct_p_value,sum_diff)
write.table(sum_table,"my_siggenes_p_adjusted.txt")
```
  
  